<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Luna Memory</title>

    <link rel="stylesheet" href="style.css">

    <!--    mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=0.8, user-scalable=0, width=device-width, shrink-to-fit=no">
    <script src="https://kit.fontawesome.com/8482ce4752.js" crossorigin="anonymous"></script>

    <!--    icons-->
    <link rel="apple-touch-icon" sizes="120x120" href="../icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../icons/favicon-16x16.png">
    <link rel="manifest" href="../icons/site.webmanifest">
    <link rel="mask-icon" href="../icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="../icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="../icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!--   og link-->
    <meta property="og:title" content="Luna Memory">
    <meta property="og:description" content="Ein Memory Spiel mit Luna, ihren Gegenständen und Freunden.">
    <meta property="og:image" content="https://leonlp9.github.io/GameOfLuna/img/skins/sherlock.png">
    <meta property="og:type" content="website">

    <!--    crawler-->
    <meta name="description" content="Ein Memory Spiel mit Luna, ihren Gegenständen und Freunden.">
    <meta name="keywords" content="Luna, Memory, Luna Memory, Game, Luna Game, Luna Memory Game, Luna Memory Game Of Luna, Game Of Luna, Luna Game Of Luna, Luna Memory Game Of Luna">
    <meta name="author" content="Leon lp9">
    <meta name="robots" content="index, follow">
    <meta name="revisit-after" content="3 days">
    <meta name="language" content="German">
    <meta name="distribution" content="Global">
    <meta name="rating" content="General">

    <style>
        * {
            user-select: none;
        }

        body {
            background: url("../img/backgrounds/bg1.png") center;
            background-size: 100px;
            image-rendering: pixelated;
        }

        .card {
            position: relative;
            width: 200px;
            height: 200px;
            perspective: 1000px;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.4, 0.2, 0.2, 1);
        }

        .card .front, .card .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card img {
            width: calc(100% - 40px);
            height: calc(100% - 40px);
            object-fit: contain;
        }

        .card .back {
            transform: rotateY(180deg);
            background: url("gameImg/cardRueckseite.png") center center no-repeat;
            background-size: cover;
        }

        .card .front {
            transform: rotateY(0deg);
            background: url("gameImg/cardVorderseite.png") center center no-repeat;
            background-size: cover;
        }

        .card.open {
            transform: rotateY(180deg);
        }

        .matched {
            animation: matched 1s cubic-bezier(0.4, 0.2, 0.2, 1);
            animation-fill-mode: forwards;
        }

        @keyframes matched {
            0% {
                transform: scale(1) rotateY(180deg);
            }
            50% {
                transform: scale(1.1) rotateY(180deg);
            }
            100% {
                transform: scale(1) rotateY(180deg);
            }
        }

        #cards {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            align-content: center;
            gap: 10px;
        }
    </style>
</head>
<body>
<div id="cards"></div>

    <script>

        //rechtsklick wird zu linksklick
        document.addEventListener('contextmenu', event => {
            event.preventDefault();
            event.target.click();
        });


        const cardImageLinks = [
            '../img/auto.png',
            '../img/informatik.png',
            '../img/kaffeemaschine.png',
            '../img/kaninchen.png',
            '../img/laptop.png',
            '../img/lenkrad.png',
            '../img/ram.png',
            '../img/rollerblades.png',
            '../img/speicherkarte.png',
            '../img/superluna.png',
            '../img/skins/sherlock.png',
            '../img/skins/race.png',
            '../img/skins/allergie.webp',
            '../img/skins/clicker.webp',
            '../img/skins/business.png',
        ]

        //get random image links with amount of parameter, no duplicates
        function getRandomImageLinks(amount) {
            if (amount > cardImageLinks.length) throw new Error('Amount is greater than the amount of available card image links');

            const randomImageLinks = [];
            while (randomImageLinks.length < amount) {
                const randomIndex = Math.floor(Math.random() * cardImageLinks.length);
                const randomImageLink = cardImageLinks[randomIndex];
                if (!randomImageLinks.includes(randomImageLink)) {
                    randomImageLinks.push(randomImageLink);
                }
            }
            return randomImageLinks;
        }

        function addCardToCards(cardImageLink) {
            const card = document.createElement('div');
            card.classList.add('card');

            card.dataset.imageLink = cardImageLink;

            card.innerHTML = `
                <div class="front"></div>
                <div class="back">
                    <img src="${cardImageLink}" alt="Back">
                </div>
            `;
            document.getElementById('cards').appendChild(card);
        }

        function shuffleCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const randomIndex = Math.floor(Math.random() * cards.length);
                const randomCard = cards[randomIndex];
                card.parentNode.insertBefore(randomCard, card);
            });
        }

        const randomImageLinks = getRandomImageLinks(10);

        randomImageLinks.forEach(imageLink => {
            addCardToCards(imageLink);
            addCardToCards(imageLink);
        });

        shuffleCards();

        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('click', () => {
                if (card.classList.contains('open')) return;
                if (getOpenCards().length >= 2) return;
                if (card.classList.contains('matched')) return;

                card.classList.add('open');

                const openCards = getOpenCards();
                if (openCards.length === 2) {
                    const [firstCard, secondCard] = openCards;
                    if (firstCard.dataset.imageLink === secondCard.dataset.imageLink) {
                        openCards.forEach(card => {
                            setTimeout(() => {
                                card.classList.remove('open');
                                card.classList.add('matched');
                            }, 750);
                        });
                    } else {
                        setTimeout(() => {
                            closeOpenCards();
                        }, 1500);
                    }
                }
            });
        });

        function getOpenCards() {
            return Array.from(document.querySelectorAll('.card.open'));
        }

        function closeOpenCards() {
            getOpenCards().forEach(card => {
                card.classList.remove('open');
            });
        }
    </script>
</body>
</html>